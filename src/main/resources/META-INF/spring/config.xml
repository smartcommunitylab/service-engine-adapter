<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xmlns:context="http://www.springframework.org/schema/context" xmlns:camel="http://camel.apache.org/schema/spring"
	xmlns:cxf="http://camel.apache.org/schema/cxf" xmlns:osgix="http://www.springframework.org/schema/osgi-compendium"
	xsi:schemaLocation="http://www.springframework.org/schema/beans
	http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
	http://www.springframework.org/schema/context
	http://www.springframework.org/schema/context/spring-context-3.0.xsd
	http://camel.apache.org/schema/spring
	http://camel.apache.org/schema/spring/camel-spring.xsd
	http://camel.apache.org/schema/cxf
	http://camel.apache.org/schema/cxf/camel-cxf.xsd
	http://www.springframework.org/schema/osgi-compendium
	http://www.springframework.org/schema/osgi-compendium/spring-osgi-compendium.xsd">

	<!-- ServiceActionInvoke -->
	<camel:camelContext xmlns="http://camel.apache.org/schema/spring">
		<route>
			<from uri="activemq:queue:sb/ServiceActionInvokeQueue" />
			<to uri="jms:queue:ServiceActionInvokeQueue?mapJmsMessage=false&amp;messageConverter=#messageConverter" />
		</route>
	</camel:camelContext>
	
	<!-- ServiceDataChangeSubscribe -->
	<camel:camelContext xmlns="http://camel.apache.org/schema/spring">
		<route>
			<from uri="activemq:queue:sb/ServiceDataChangeSubscribeQueue" />
			<to uri="jms:queue:ServiceDataChangeSubscribeQueue?mapJmsMessage=false&amp;messageConverter=#messageConverter" />
		</route>
	</camel:camelContext>

	<!-- ServiceDataChangeUnsubscribe -->
	<camel:camelContext xmlns="http://camel.apache.org/schema/spring">
		<route>
			<from uri="activemq:queue:sb/ServiceDataChangeUnsubscribeQueue" />
			<to uri="jms:queue:ServiceDataChangeUnsubscribeQueue?mapJmsMessage=false&amp;messageConverter=#messageConverter" />
		</route>
	</camel:camelContext>

	<!-- ServiceDataChangeNotify -->
	<camel:camelContext xmlns="http://camel.apache.org/schema/spring">
		<route>
			<from uri="jms:queue:ServiceDataChangeNotifyQueue" />
			<to uri="activemq:queue:sb/ServiceDataChangeNotifyQueue" />
		</route>
	</camel:camelContext>
	
	<!-- DomainObjectEventSubscribe -->
	<camel:camelContext xmlns="http://camel.apache.org/schema/spring">
		<route>
			<from uri="activemq:queue:sb/DomainObjectEventSubscribeQueue" />
			<to uri="jms:queue:DomainObjectEventSubscribeQueue?mapJmsMessage=false&amp;messageConverter=#messageConverter" />
		</route>
	</camel:camelContext>

	<!-- DomainObjectEventUnsubscribe -->
	<camel:camelContext xmlns="http://camel.apache.org/schema/spring">
		<route>
			<from uri="activemq:queue:sb/DomainObjectEventUnsubscribeQueue" />
			<to uri="jms:queue:DomainObjectEventUnsubscribeQueue?mapJmsMessage=false&amp;messageConverter=#messageConverter" />
		</route>
	</camel:camelContext>
	
	<!-- DomainBundleTermination -->
	<camel:camelContext xmlns="http://camel.apache.org/schema/spring">
		<route>
			<from uri="jms:queue:DomainBundleTerminationQueue" />
			<to uri="activemq:queue:sb/DomainBundleTerminationQueue" />
		</route>
	</camel:camelContext>
	
	<!-- ProcessDoOperation -->
	<camel:camelContext xmlns="http://camel.apache.org/schema/spring">
		<route>
			<from uri="activemq:queue:sb/ProcessDoOperationQueue" />
			<to uri="jms:queue:ProcessDoOperationQueue?mapJmsMessage=false&amp;messageConverter=#messageConverter" />
		</route>
	</camel:camelContext>

	<!-- ProcessDoOperationSynch -->
	<camel:camelContext xmlns="http://camel.apache.org/schema/spring">
		<route>
			<from uri="activemq:queue:sb/ProcessDoOperationSynchQueue" />
			<to uri="jms:queue:ProcessDoOperationSynchQueue?mapJmsMessage=false&amp;messageConverter=#messageConverter" />
		</route>
	</camel:camelContext>
	
	<!-- ProcessDoSearch -->
	<camel:camelContext xmlns="http://camel.apache.org/schema/spring">
		<route>
			<from uri="activemq:queue:sb/ProcessDoSearchQueue" />
			<to uri="jms:queue:ProcessDoSearchQueue?mapJmsMessage=false&amp;messageConverter=#messageConverter" />
		</route>
	</camel:camelContext>
	
	<!-- ProcessDoDataRequest -->
	<camel:camelContext xmlns="http://camel.apache.org/schema/spring">
		<route>
			<from uri="jms:queue:ProcessDoDataRequestQueue" />
			<to uri="activemq:queue:sb/ProcessDoDataRequestQueue" />
		</route>
	</camel:camelContext>

	<!-- ProcessDoSignal -->
	<camel:camelContext xmlns="http://camel.apache.org/schema/spring">
		<route>
			<from uri="activemq:queue:sb/ProcessDoSignalQueue" />
			<to uri="jms:queue:ProcessDoSignalQueue?mapJmsMessage=false&amp;messageConverter=#messageConverter" />
		</route>
	</camel:camelContext>
	
	<bean id="messageConverter" class="it.sayservice.platform.smx.converter.SBOMessageConverter" />

	<bean id="jms" class="org.apache.camel.component.jms.JmsComponent">
		<property name="connectionFactory">
			<bean class="org.hornetq.jms.client.HornetQJMSConnectionFactory">
				<constructor-arg value="false" />
				<constructor-arg>
					<bean class="org.hornetq.api.core.TransportConfiguration">
						<constructor-arg value="org.hornetq.core.remoting.impl.netty.NettyConnectorFactory" />
						<constructor-arg>
							<map key-type="java.lang.String" value-type="java.lang.Object">
								<entry key="host" value="${hornetQ.discoveryAddress}" />
								<entry key="port" value="${hornetQ.discoveryPort}" />
							</map>
						</constructor-arg>
					</bean>
				</constructor-arg>
			</bean>
		</property>
	</bean>

	<bean id="activemq" class="org.apache.activemq.camel.component.ActiveMQComponent">
		<property name="brokerURL" value="${activeMQ.brokerURL}" />
	</bean>

	<osgix:cm-properties id="preProps" persistent-id="serviceengine.adapter.properties">
		<!-- These are the default values. -->
		<!-- Check serviceengine.adapter.properties.cfg for information -->
		<prop key="hornetQ.discoveryAddress">localhost</prop>
		<prop key="hornetQ.discoveryPort">5445</prop>
		<prop key="activeMQ.brokerURL">tcp://localhost:61616</prop>
	</osgix:cm-properties>

	<context:property-placeholder properties-ref="preProps" />
</beans>
